---
import Layout from "../../layouts/Layout.astro";
import { getCollection, render } from "astro:content";

export async function getStaticPaths() {
  const posts = await getCollection("blog");
  return posts.map((post) => ({
    params: { id: post.id },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await render(post);
---

<Layout title={post.data.title}>
  <div class="paper-texture"></div>

  <article class="journal-post">
    <header class="post-header">
      <div class="post-meta">
        <span class="date">{post.data.pubDate.toLocaleDateString('zh-TW')}</span>
        <span class="sep">/</span>
        <span class="location">於 {post.data.location || '台北'}</span>
      </div>
      <h1 class="post-title">{post.data.title}</h1>
      <div class="mood-tag">
        今日心情：<span class="mood-text">{post.data.mood || '平靜'}</span>
      </div>
    </header>

    <section class="post-content">
      <Content />
    </section>

    <footer class="post-footer">
      <hr class="ink-line" />
      <div class="tech-stack">
        {post.data.techStack && post.data.techStack.length > 0 && (
          <p>當日探究：{post.data.techStack.join(', ')}</p>
        )}
      </div>
      <a href="/blog" class="back-link">← 回到日誌目錄</a>
    </footer>
  </article>
</Layout>

<style>
  .journal-post {
    max-width: 700px;
    margin: 5rem auto;
    padding: 0 1.5rem;
    font-family: "Noto Serif TC", serif;
    color: var(--ink);
    line-height: 2; /* 增加行距，提升人文感的呼吸空間 */
  }

  .post-header { text-align: center; margin-bottom: 4rem; }
  .post-meta { font-size: 0.9rem; color: var(--muted); letter-spacing: 1px; }
  .post-title { font-size: 2.4rem; margin: 1rem 0; font-weight: 700; }
  
  .mood-tag {
    display: inline-block;
    padding: 4px 12px;
    background: rgba(139, 69, 19, 0.05);
    border-radius: 20px;
    font-size: 0.85rem;
    color: var(--accent);
  }

  /* 文章內容樣式優化 */
  .post-content { font-size: 1.1rem; text-align: justify; }
  .post-content :global(p) { margin-bottom: 2rem; }
  .post-content :global(h2) { font-size: 1.5rem; margin-top: 3rem; border-left: 3px solid var(--accent); padding-left: 1rem; }

  .post-footer { margin-top: 6rem; text-align: center; color: var(--muted); }
  .ink-line { border: 0; border-top: 1px solid var(--border); margin-bottom: 2rem; }
  .back-link { text-decoration: none; color: var(--accent); font-size: 0.9rem; transition: 0.3s; }
  .back-link:hover { text-decoration: underline; }
</style>