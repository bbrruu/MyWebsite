---
import Layout from "../../layouts/Layout.astro";
import { getCollection, render } from "astro:content";

export async function getStaticPaths() {
  const posts = await getCollection("reading");
  return posts.map((post) => ({
    params: { id: post.id },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await render(post);
---

<Layout title={`${post.data.title} | 閱測筆記 - Bruce`}>
  <div class="paper-texture"></div>

  <article class="content-article">
    <nav class="inner-nav">
      <a href="/reading" class="back-link">
        <span class="arrow">←</span>
        <span class="text">INDEX / READING NOTES</span>
      </a>
    </nav>

    <header class="post-header">
      <div class="post-meta-card">
        <div class="meta-grid">
          <span class="meta-label">WRITER</span>
          <span class="meta-value author-name">{post.data.author || '待補充'}</span>

          <span class="meta-label">BOOK</span>
          <span class="meta-value">《{post.data.bookTitle}》</span>

          <span class="meta-label">REVIEWED</span>
          <span class="meta-value date">{post.data.pubDate.toLocaleDateString('zh-TW', { year: 'numeric', month: '2-digit', day: '2-digit' })}</span>
        </div>
      </div>

      <div class="title-wrapper">
        <h1 class="post-title">〈{post.data.title}〉</h1>
      </div>
      <div class="dynamic-accent-line"></div>
    </header>

    <section class="post-content">
      <Content />
    </section>

    <footer class="post-footer">
      <div class="footer-info">
        <span>Scholar's Archive</span>
        <span class="dot">•</span>
        <span>National Taiwan University / Linguistics</span>
      </div>
    </footer>
  </article>
</Layout>

<style>
  .content-article { width: 100%; padding: 0; font-family: "Noto Serif TC", serif; color: var(--ink); }
  .inner-nav { margin-bottom: 1.5rem; }
  .back-link { display: inline-flex; align-items: center; text-decoration: none; color: var(--muted); font-size: 0.7rem; letter-spacing: 2px; font-family: sans-serif; }
  .back-link:hover { color: var(--accent); }
  .back-link .arrow { margin-right: 8px; transition: 0.4s ease; }

  .post-header { position: relative; margin-top: 0; }
  .title-wrapper { padding-right: 380px; }
  .post-title { font-size: 2rem; margin: 0; font-weight: 700; letter-spacing: -1.5px; line-height: 1.4; color: var(--ink); padding-bottom: 1rem; }
  .dynamic-accent-line { width: 100%; height: 4px; background-color: var(--accent); border-radius: 2px; }

  .post-meta-card { position: absolute; bottom: 1rem; right: 0; background: rgba(139, 69, 19, 0.03); border: 1px solid var(--border); padding: 0.6rem 0.9rem; border-radius: 4px; width: max-content; min-width: 200px; max-width: 360px; }
  .meta-grid { display: grid; grid-template-columns: auto max-content; align-items: baseline; column-gap: 0.7rem; row-gap: 0.35rem; }
  .meta-label { font-size: 0.55rem; font-family: sans-serif; color: var(--muted); letter-spacing: 1.5px; font-weight: 700; text-transform: uppercase; }
  .meta-value { font-size: 0.72rem; font-family: sans-serif; color: var(--muted); font-weight: 600; }
  .author-name { color: var(--accent); font-size: 0.78rem; font-weight: 700; font-family: "Noto Serif TC", serif; }

  .post-content { width: 100%; line-height: 2.2; font-size: 1.15rem; text-align: justify; margin-top: 1.8rem; }
  .post-footer { margin-top: 10rem; padding-top: 2rem; border-top: 1px dashed var(--border); }
  .footer-info { display: flex; align-items: center; gap: 1rem; font-size: 0.75rem; color: var(--muted); font-family: sans-serif; }

  @media (max-width: 768px) {
    .post-header { padding-right: 0; }
    .post-meta-card { position: static; width: 100%; margin-top: 1rem; }
  }
</style>